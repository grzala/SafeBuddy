<div class="container-fluid" id="main">
<div class="row">
	<div class="col-xs-6" id="left">
		<p>Sumary of crimes in <%= @region.name %> in years 2009-2014</p>
		<p>The most popular crimes in your region belong to the group: <span id="highest-council"></span></p>
		<div class="small-pie-chart" id="council"></div>
	</div>
	<div class="col-xs-6">
		<p>Summary of crimes in <%= @police_region.name %> police region in years 2009-2014</p>
		<p>The most popular crimes in your region  are: <span id="highest-crime"></span></p>
		<p>The most popular violent crimes in your region are: <span id="highest-violent"></p>
		<div class="small-pie-chart" id="crimes"></div>
		<div class="small-pie-chart" id="violent"></div>
	</div>
</div>
</div>


<%= javascript_tag do %>
  window.policeRegionId = '<%= @police_region_id %>';
  window.regionId = '<%= @region_id %>';
<% end %>

<script>
	
	$(document).ready(function() {
	$.ajax({
		type: "GET",
		url: "/regions/"+regionId,
		dataType: "json",
		success: function(crimes) {
			var newCrimes = createCrimesCouncilPieChart(crimes);
			
			//get highest
			var highest = ["", 0];
			for (group in newCrimes) {
				if (newCrimes[group] > highest[1]) highest = [group, newCrimes[group]];
			}
			$("#highest-council").text(highest[0]);
		}
	});
	
	$.ajax({
		type: "GET",
		url: "/police_regions/"+policeRegionId,
		dataType: "json",
		success: function(crimes) {
			var newCrimes = createCrimesRegionPieChart(crimes, "all");
			var newViolentCrimes = createViolentRegionPieChart(crimes, "all");
			
			//get highest
			var highest = ["", 0];
			for (index in newCrimes) {
				if (newCrimes[index].y > highest[1]) highest = [newCrimes[index].name, newCrimes[index].y];
			}
			$("#highest-crime").text(highest[0]);
			
			highest = ["", 0];
			for (index in newViolentCrimes) {
				if (newViolentCrimes[index].y > highest[1]) highest = [newViolentCrimes[index].name, newViolentCrimes[index].y];
			}
			$("#highest-violent").text(highest[0]);
		}
	});
	
	});
	
</script>
